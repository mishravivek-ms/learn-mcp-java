# MCP Java Client - Visual Data Flow Diagram

## ğŸ¨ Visual Data Flow Representation

This document provides visual representations of how data flows through the MCP Java Client system.

---

## ğŸ”„ Complete System Data Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                           MCP JAVA CLIENT SYSTEM                                                   â”‚
â”‚                                                                                                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚    USER     â”‚    â”‚     CLI     â”‚    â”‚ ChatService â”‚    â”‚   Ollama    â”‚    â”‚ToolsService â”‚    â”‚ MCP Server  â”‚  â”‚
â”‚  â”‚  Interface  â”‚    â”‚  Commands   â”‚    â”‚   (Core)    â”‚    â”‚    LLM      â”‚    â”‚   (MCP)     â”‚    â”‚   (Tools)   â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚         â”‚                   â”‚                   â”‚                   â”‚                   â”‚                   â”‚     â”‚
â”‚         â”‚                   â”‚                   â”‚                   â”‚                   â”‚                   â”‚     â”‚
â”‚    â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â” â”‚
â”‚    â”‚  Input  â”‚         â”‚ Command â”‚         â”‚  Chat   â”‚         â”‚   LLM   â”‚         â”‚  Tool   â”‚         â”‚  Tool   â”‚ â”‚
â”‚    â”‚Processingâ”‚         â”‚Routing  â”‚         â”‚Processingâ”‚         â”‚Analysis â”‚         â”‚Discoveryâ”‚         â”‚Executionâ”‚ â”‚
â”‚    â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜ â”‚
â”‚         â”‚                   â”‚                   â”‚                   â”‚                   â”‚                   â”‚     â”‚
â”‚         â”‚                   â”‚                   â”‚                   â”‚                   â”‚                   â”‚     â”‚
â”‚    â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â” â”‚
â”‚    â”‚Response â”‚         â”‚ Service â”‚         â”‚ Memory  â”‚         â”‚  Tool   â”‚         â”‚  Tool   â”‚         â”‚ Result  â”‚ â”‚
â”‚    â”‚Display  â”‚         â”‚Dispatch â”‚         â”‚Managementâ”‚         â”‚Selectionâ”‚         â”‚Provider â”‚         â”‚Processingâ”‚ â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ¯ Detailed Request-Response Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                        REQUEST-RESPONSE CYCLE                                                      â”‚
â”‚                                                                                                                     â”‚
â”‚  USER INPUT: "What monkey species do you know?"                                                                    â”‚
â”‚      â”‚                                                                                                             â”‚
â”‚      â–¼                                                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚                                    PHASE 1: INPUT PROCESSING                                                  â”‚ â”‚
â”‚  â”‚                                                                                                               â”‚ â”‚
â”‚  â”‚  ChatCommand.run() â†’ ChatService.startInteractiveChat() â†’ scanner.nextLine()                                â”‚ â”‚
â”‚  â”‚                                          â”‚                                                                   â”‚ â”‚
â”‚  â”‚                                          â–¼                                                                   â”‚ â”‚
â”‚  â”‚  Input Validation â†’ Trim â†’ Check Exit Commands â†’ Route to AI Services                                       â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                         â”‚                                                                         â”‚
â”‚                                         â–¼                                                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚                                   PHASE 2: AI PROCESSING                                                     â”‚ â”‚
â”‚  â”‚                                                                                                               â”‚ â”‚
â”‚  â”‚  bot.chat(userId, message) â†’ AiServices â†’ OllamaChatModel                                                    â”‚ â”‚
â”‚  â”‚                                          â”‚                                                                   â”‚ â”‚
â”‚  â”‚                                          â–¼                                                                   â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                           â”‚ â”‚
â”‚  â”‚  â”‚ Memory Retrievalâ”‚   â”‚ Context Buildingâ”‚   â”‚ LLM Inference   â”‚                                           â”‚ â”‚
â”‚  â”‚  â”‚ (Last 20 msgs)  â”‚   â”‚ (System + User) â”‚   â”‚ (Ollama Server) â”‚                                           â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                           â”‚ â”‚
â”‚  â”‚                                          â”‚                                                                   â”‚ â”‚
â”‚  â”‚                                          â–¼                                                                   â”‚ â”‚
â”‚  â”‚  LLM Decision: "User wants monkey species information - use get_monkey_species tool"                        â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                         â”‚                                                                         â”‚
â”‚                                         â–¼                                                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚                                  PHASE 3: TOOL EXECUTION                                                     â”‚ â”‚
â”‚  â”‚                                                                                                               â”‚ â”‚
â”‚  â”‚  McpToolProvider.executeTool() â†’ McpClient.callTool() â†’ HTTP SSE Request                                     â”‚ â”‚
â”‚  â”‚                                          â”‚                                                                   â”‚ â”‚
â”‚  â”‚                                          â–¼                                                                   â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                           â”‚ â”‚
â”‚  â”‚  â”‚ Tool Selection  â”‚   â”‚ Parameter Prep  â”‚   â”‚ MCP Server Call â”‚                                           â”‚ â”‚
â”‚  â”‚  â”‚get_monkey_speciesâ”‚   â”‚     params: {}  â”‚   â”‚ SSE Transport   â”‚                                           â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                           â”‚ â”‚
â”‚  â”‚                                          â”‚                                                                   â”‚ â”‚
â”‚  â”‚                                          â–¼                                                                   â”‚ â”‚
â”‚  â”‚  MCP Server Response: ["Rhesus Macaque", "Chimpanzee", "Baboon", "Orangutan"]                               â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                         â”‚                                                                         â”‚
â”‚                                         â–¼                                                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚                                 PHASE 4: RESPONSE SYNTHESIS                                                  â”‚ â”‚
â”‚  â”‚                                                                                                               â”‚ â”‚
â”‚  â”‚  LLM Response Generation â†’ Context Integration â†’ Natural Language Output                                     â”‚ â”‚
â”‚  â”‚                                          â”‚                                                                   â”‚ â”‚
â”‚  â”‚                                          â–¼                                                                   â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                           â”‚ â”‚
â”‚  â”‚  â”‚ Tool Results    â”‚   â”‚ Context Merge   â”‚   â”‚ Response Format â”‚                                           â”‚ â”‚
â”‚  â”‚  â”‚ Integration     â”‚   â”‚ (User + Tools)  â”‚   â”‚ (Natural Lang)  â”‚                                           â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                           â”‚ â”‚
â”‚  â”‚                                          â”‚                                                                   â”‚ â”‚
â”‚  â”‚                                          â–¼                                                                   â”‚ â”‚
â”‚  â”‚  Final Response: "I can tell you about several monkey species..."                                            â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                         â”‚                                                                         â”‚
â”‚                                         â–¼                                                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚                                  PHASE 5: OUTPUT DELIVERY                                                    â”‚ â”‚
â”‚  â”‚                                                                                                               â”‚ â”‚
â”‚  â”‚  Response Formatting â†’ Console Output â†’ Memory Storage â†’ Loop Back                                           â”‚ â”‚
â”‚  â”‚                                          â”‚                                                                   â”‚ â”‚
â”‚  â”‚                                          â–¼                                                                   â”‚ â”‚
â”‚  â”‚  USER OUTPUT: "I can tell you about several monkey species: Rhesus Macaque..."                              â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ§  LLM Decision Tree

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                         LLM DECISION TREE                                                          â”‚
â”‚                                                                                                                     â”‚
â”‚                                      USER INPUT RECEIVED                                                           â”‚
â”‚                                             â”‚                                                                       â”‚
â”‚                                             â–¼                                                                       â”‚
â”‚                                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                             â”‚
â”‚                                    â”‚ INTENT ANALYSIS â”‚                                                             â”‚
â”‚                                    â”‚                 â”‚                                                             â”‚
â”‚                                    â”‚ â€¢ Parse Query   â”‚                                                             â”‚
â”‚                                    â”‚ â€¢ Extract Intentâ”‚                                                             â”‚
â”‚                                    â”‚ â€¢ Identify Domainâ”‚                                                            â”‚
â”‚                                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                                             â”‚
â”‚                                             â”‚                                                                       â”‚
â”‚                                             â–¼                                                                       â”‚
â”‚                              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                               â”‚
â”‚                              â”‚          DECISION POINT             â”‚                                               â”‚
â”‚                              â”‚                                     â”‚                                               â”‚
â”‚                              â”‚    Does query need external        â”‚                                               â”‚
â”‚                              â”‚    information or tools?            â”‚                                               â”‚
â”‚                              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                               â”‚
â”‚                                      â”‚                    â”‚                                                         â”‚
â”‚                                     YES                  NO                                                         â”‚
â”‚                                      â”‚                    â”‚                                                         â”‚
â”‚                                      â–¼                    â–¼                                                         â”‚
â”‚                        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                          â”‚
â”‚                        â”‚   TOOL SELECTION    â”‚   â”‚  DIRECT RESPONSE    â”‚                                          â”‚
â”‚                        â”‚                     â”‚   â”‚                     â”‚                                          â”‚
â”‚                        â”‚ â€¢ Analyze Available â”‚   â”‚ â€¢ Use Built-in      â”‚                                          â”‚
â”‚                        â”‚   Tools             â”‚   â”‚   Knowledge         â”‚                                          â”‚
â”‚                        â”‚ â€¢ Match to Query    â”‚   â”‚ â€¢ Generate Response â”‚                                          â”‚
â”‚                        â”‚ â€¢ Rank by Relevanceâ”‚   â”‚ â€¢ Return to User    â”‚                                          â”‚
â”‚                        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                          â”‚
â”‚                                      â”‚                    â”‚                                                         â”‚
â”‚                                      â–¼                    â”‚                                                         â”‚
â”‚                        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚                                                         â”‚
â”‚                        â”‚  TOOL EXECUTION     â”‚            â”‚                                                         â”‚
â”‚                        â”‚                     â”‚            â”‚                                                         â”‚
â”‚                        â”‚ â€¢ Prepare Parametersâ”‚            â”‚                                                         â”‚
â”‚                        â”‚ â€¢ Call MCP Tools    â”‚            â”‚                                                         â”‚
â”‚                        â”‚ â€¢ Handle Results    â”‚            â”‚                                                         â”‚
â”‚                        â”‚ â€¢ Error Recovery    â”‚            â”‚                                                         â”‚
â”‚                        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚                                                         â”‚
â”‚                                      â”‚                    â”‚                                                         â”‚
â”‚                                      â–¼                    â”‚                                                         â”‚
â”‚                        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚                                                         â”‚
â”‚                        â”‚ RESULT INTEGRATION  â”‚            â”‚                                                         â”‚
â”‚                        â”‚                     â”‚            â”‚                                                         â”‚
â”‚                        â”‚ â€¢ Combine Tool Data â”‚            â”‚                                                         â”‚
â”‚                        â”‚ â€¢ Add Context       â”‚            â”‚                                                         â”‚
â”‚                        â”‚ â€¢ Generate Response â”‚            â”‚                                                         â”‚
â”‚                        â”‚ â€¢ Format Output     â”‚            â”‚                                                         â”‚
â”‚                        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚                                                         â”‚
â”‚                                      â”‚                    â”‚                                                         â”‚
â”‚                                      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                                         â”‚
â”‚                                             â”‚                                                                       â”‚
â”‚                                             â–¼                                                                       â”‚
â”‚                                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                             â”‚
â”‚                                    â”‚ RESPONSE OUTPUT â”‚                                                             â”‚
â”‚                                    â”‚                 â”‚                                                             â”‚
â”‚                                    â”‚ â€¢ Format Text   â”‚                                                             â”‚
â”‚                                    â”‚ â€¢ Update Memory â”‚                                                             â”‚
â”‚                                    â”‚ â€¢ Return to Userâ”‚                                                             â”‚
â”‚                                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                                             â”‚
â”‚                                                                                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”„ Memory Management Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                       MEMORY MANAGEMENT                                                            â”‚
â”‚                                                                                                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                      â”‚
â”‚  â”‚  NEW MESSAGE    â”‚    â”‚  MEMORY STORE   â”‚    â”‚ CONTEXT WINDOW  â”‚    â”‚  LLM CONTEXT    â”‚                      â”‚
â”‚  â”‚   RECEIVED      â”‚    â”‚   RETRIEVAL     â”‚    â”‚   MANAGEMENT    â”‚    â”‚   BUILDING      â”‚                      â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                      â”‚
â”‚            â”‚                       â”‚                       â”‚                       â”‚                             â”‚
â”‚            â–¼                       â–¼                       â–¼                       â–¼                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚                                    MEMORY OPERATIONS                                                         â”‚ â”‚
â”‚  â”‚                                                                                                               â”‚ â”‚
â”‚  â”‚  1. Input Processing                                                                                         â”‚ â”‚
â”‚  â”‚     â””â”€ User: "What monkey species do you know?"                                                              â”‚ â”‚
â”‚  â”‚                                                                                                               â”‚ â”‚
â”‚  â”‚  2. Memory Retrieval                                                                                         â”‚ â”‚
â”‚  â”‚     â””â”€ InMemoryChatMemoryStore.getMessages(userId, limit=20)                                                 â”‚ â”‚
â”‚  â”‚                                                                                                               â”‚ â”‚
â”‚  â”‚  3. Context Window Building                                                                                  â”‚ â”‚
â”‚  â”‚     â”œâ”€ System Message: "You are a helpful AI assistant..."                                                   â”‚ â”‚
â”‚  â”‚     â”œâ”€ Previous Messages: [message1, message2, ...]                                                          â”‚ â”‚
â”‚  â”‚     â””â”€ Current Message: "What monkey species do you know?"                                                   â”‚ â”‚
â”‚  â”‚                                                                                                               â”‚ â”‚
â”‚  â”‚  4. LLM Processing                                                                                            â”‚ â”‚
â”‚  â”‚     â””â”€ OllamaChatModel.doChat(contextMessages)                                                               â”‚ â”‚
â”‚  â”‚                                                                                                               â”‚ â”‚
â”‚  â”‚  5. Response Generation                                                                                       â”‚ â”‚
â”‚  â”‚     â””â”€ AI: "I can tell you about several monkey species..."                                                  â”‚ â”‚
â”‚  â”‚                                                                                                               â”‚ â”‚
â”‚  â”‚  6. Memory Update                                                                                             â”‚ â”‚
â”‚  â”‚     â”œâ”€ Store User Message                                                                                    â”‚ â”‚
â”‚  â”‚     â”œâ”€ Store AI Response                                                                                     â”‚ â”‚
â”‚  â”‚     â””â”€ Update Conversation History                                                                            â”‚ â”‚
â”‚  â”‚                                                                                                               â”‚ â”‚
â”‚  â”‚  7. Window Management                                                                                         â”‚ â”‚
â”‚  â”‚     â”œâ”€ Check message count (max 20)                                                                          â”‚ â”‚
â”‚  â”‚     â”œâ”€ Remove oldest if needed                                                                               â”‚ â”‚
â”‚  â”‚     â””â”€ Maintain conversation continuity                                                                       â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                                                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚                                    MEMORY STRUCTURE                                                           â”‚ â”‚
â”‚  â”‚                                                                                                               â”‚ â”‚
â”‚  â”‚  User ID: "user-12345678"                                                                                    â”‚ â”‚
â”‚  â”‚  â”œâ”€ Message 1: {type: "user", content: "Hello", timestamp: "..."}                                           â”‚ â”‚
â”‚  â”‚  â”œâ”€ Message 2: {type: "ai", content: "Hi! How can I help?", timestamp: "..."}                              â”‚ â”‚
â”‚  â”‚  â”œâ”€ Message 3: {type: "user", content: "Tell me about monkeys", timestamp: "..."}                          â”‚ â”‚
â”‚  â”‚  â”œâ”€ Message 4: {type: "ai", content: "Monkeys are primates...", timestamp: "..."}                          â”‚ â”‚
â”‚  â”‚  â””â”€ ... (up to 20 messages)                                                                                  â”‚ â”‚
â”‚  â”‚                                                                                                               â”‚ â”‚
â”‚  â”‚  Memory Properties:                                                                                           â”‚ â”‚
â”‚  â”‚  â”œâ”€ Max Messages: 20                                                                                         â”‚ â”‚
â”‚  â”‚  â”œâ”€ Storage Type: In-Memory                                                                                  â”‚ â”‚
â”‚  â”‚  â”œâ”€ Eviction Policy: FIFO (First In, First Out)                                                             â”‚ â”‚
â”‚  â”‚  â””â”€ Persistence: Session-based (not persistent across restarts)                                              â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”§ Tool Integration Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                       TOOL INTEGRATION                                                             â”‚
â”‚                                                                                                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                      â”‚
â”‚  â”‚ TOOL DISCOVERY  â”‚    â”‚ TOOL SELECTION  â”‚    â”‚ TOOL EXECUTION  â”‚    â”‚ RESULT HANDLING â”‚                      â”‚
â”‚  â”‚   (Startup)     â”‚    â”‚   (Runtime)     â”‚    â”‚   (Async)       â”‚    â”‚   (Integration) â”‚                      â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                      â”‚
â”‚            â”‚                       â”‚                       â”‚                       â”‚                             â”‚
â”‚            â–¼                       â–¼                       â–¼                       â–¼                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚                                   TOOL LIFECYCLE                                                             â”‚ â”‚
â”‚  â”‚                                                                                                               â”‚ â”‚
â”‚  â”‚  PHASE 1: DISCOVERY (Application Startup)                                                                    â”‚ â”‚
â”‚  â”‚  â”œâ”€ 1. Load mcp.json configuration                                                                           â”‚ â”‚
â”‚  â”‚  â”œâ”€ 2. Connect to MCP servers                                                                                â”‚ â”‚
â”‚  â”‚  â”‚    â””â”€ HTTP SSE: http://localhost:8080/mcp/sse                                                             â”‚ â”‚
â”‚  â”‚  â”œâ”€ 3. Retrieve tool specifications                                                                          â”‚ â”‚
â”‚  â”‚  â”‚    â”œâ”€ get_monkey_species: "Retrieves monkey species info"                                                 â”‚ â”‚
â”‚  â”‚  â”‚    â””â”€ get_random_monkey: "Returns random monkey information"                                               â”‚ â”‚
â”‚  â”‚  â””â”€ 4. Register tools with McpToolProvider                                                                   â”‚ â”‚
â”‚  â”‚                                                                                                               â”‚ â”‚
â”‚  â”‚  PHASE 2: SELECTION (Query Processing)                                                                       â”‚ â”‚
â”‚  â”‚  â”œâ”€ 1. LLM analyzes user query                                                                               â”‚ â”‚
â”‚  â”‚  â”‚    â””â”€ Query: "What monkey species do you know?"                                                           â”‚ â”‚
â”‚  â”‚  â”œâ”€ 2. Match query to available tools                                                                        â”‚ â”‚
â”‚  â”‚  â”‚    â”œâ”€ get_monkey_species: HIGH relevance                                                                  â”‚ â”‚
â”‚  â”‚  â”‚    â””â”€ get_random_monkey: LOW relevance                                                                    â”‚ â”‚
â”‚  â”‚  â”œâ”€ 3. Select best matching tool                                                                             â”‚ â”‚
â”‚  â”‚  â”‚    â””â”€ Selected: get_monkey_species                                                                        â”‚ â”‚
â”‚  â”‚  â””â”€ 4. Prepare tool parameters                                                                               â”‚ â”‚
â”‚  â”‚       â””â”€ Parameters: {} (empty for this tool)                                                                â”‚ â”‚
â”‚  â”‚                                                                                                               â”‚ â”‚
â”‚  â”‚  PHASE 3: EXECUTION (Tool Invocation)                                                                        â”‚ â”‚
â”‚  â”‚  â”œâ”€ 1. McpToolProvider.executeTool()                                                                         â”‚ â”‚
â”‚  â”‚  â”œâ”€ 2. McpClient.callTool()                                                                                  â”‚ â”‚
â”‚  â”‚  â”œâ”€ 3. HTTP SSE Request to MCP server                                                                        â”‚ â”‚
â”‚  â”‚  â”‚    â”œâ”€ Method: POST                                                                                        â”‚ â”‚
â”‚  â”‚  â”‚    â”œâ”€ URL: http://localhost:8080/mcp/sse                                                                  â”‚ â”‚
â”‚  â”‚  â”‚    â””â”€ Payload: {method: "tools/call", params: {name: "get_monkey_species", arguments: {}}}               â”‚ â”‚
â”‚  â”‚  â”œâ”€ 4. MCP Server Processing                                                                                 â”‚ â”‚
â”‚  â”‚  â”‚    â”œâ”€ Validate tool request                                                                               â”‚ â”‚
â”‚  â”‚  â”‚    â”œâ”€ Execute tool logic                                                                                  â”‚ â”‚
â”‚  â”‚  â”‚    â””â”€ Return results                                                                                      â”‚ â”‚
â”‚  â”‚  â””â”€ 5. Response: ["Rhesus Macaque", "Chimpanzee", "Baboon", "Orangutan"]                                    â”‚ â”‚
â”‚  â”‚                                                                                                               â”‚ â”‚
â”‚  â”‚  PHASE 4: INTEGRATION (Result Processing)                                                                    â”‚ â”‚
â”‚  â”‚  â”œâ”€ 1. Receive tool result                                                                                   â”‚ â”‚
â”‚  â”‚  â”œâ”€ 2. Validate result format                                                                                â”‚ â”‚
â”‚  â”‚  â”œâ”€ 3. Pass result back to LLM                                                                               â”‚ â”‚
â”‚  â”‚  â”œâ”€ 4. LLM synthesizes final response                                                                        â”‚ â”‚
â”‚  â”‚  â”‚    â””â”€ "I can tell you about several monkey species: Rhesus Macaque..."                                   â”‚ â”‚
â”‚  â”‚  â””â”€ 5. Return to user                                                                                        â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                                                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚                                    ERROR HANDLING                                                             â”‚ â”‚
â”‚  â”‚                                                                                                               â”‚ â”‚
â”‚  â”‚  Connection Errors:                                                                                           â”‚ â”‚
â”‚  â”‚  â”œâ”€ MCP server unavailable â†’ Skip server, continue with others                                               â”‚ â”‚
â”‚  â”‚  â”œâ”€ Network timeout â†’ Retry with exponential backoff                                                         â”‚ â”‚
â”‚  â”‚  â””â”€ Invalid response â†’ Log error, use fallback                                                               â”‚ â”‚
â”‚  â”‚                                                                                                               â”‚ â”‚
â”‚  â”‚  Tool Execution Errors:                                                                                       â”‚ â”‚
â”‚  â”‚  â”œâ”€ Tool not found â†’ Use LLM built-in knowledge                                                              â”‚ â”‚
â”‚  â”‚  â”œâ”€ Invalid parameters â†’ Retry with corrected parameters                                                     â”‚ â”‚
â”‚  â”‚  â””â”€ Execution failure â†’ Graceful degradation                                                                 â”‚ â”‚
â”‚  â”‚                                                                                                               â”‚ â”‚
â”‚  â”‚  Recovery Strategies:                                                                                         â”‚ â”‚
â”‚  â”‚  â”œâ”€ Circuit breaker pattern for failing tools                                                                â”‚ â”‚
â”‚  â”‚  â”œâ”€ Fallback to built-in LLM knowledge                                                                       â”‚ â”‚
â”‚  â”‚  â””â”€ User notification with troubleshooting tips                                                              â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“Š Performance and Timing Diagram

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                    PERFORMANCE TIMELINE                                                            â”‚
â”‚                                                                                                                     â”‚
â”‚  Time: 0s    1s    2s    3s    4s    5s    6s    7s    8s    9s    10s   11s   12s   13s   14s   15s             â”‚
â”‚        â”‚     â”‚     â”‚     â”‚     â”‚     â”‚     â”‚     â”‚     â”‚     â”‚     â”‚     â”‚     â”‚     â”‚     â”‚     â”‚               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚                                   STARTUP PHASE                                                              â”‚ â”‚
â”‚  â”‚  â”œâ”€ App Init â”€â”€â”¤                                                                                             â”‚ â”‚
â”‚  â”‚  â”‚             â”œâ”€ Ollama Connect â”€â”€â”¤                                                                         â”‚ â”‚
â”‚  â”‚  â”‚             â”‚                   â”œâ”€ MCP Discovery â”€â”€â”¤                                                     â”‚ â”‚
â”‚  â”‚  â”‚             â”‚                   â”‚                  â”œâ”€ Health Check â”€â”€â”¤                                  â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                          â”‚                                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚                                  QUERY PROCESSING                                                            â”‚ â”‚
â”‚  â”‚                                                       â”œâ”€ Input Parse â”€â”€â”¤                                    â”‚ â”‚
â”‚  â”‚                                                       â”‚                â”œâ”€ Memory Load â”€â”€â”¤                  â”‚ â”‚
â”‚  â”‚                                                       â”‚                â”‚                â”œâ”€ LLM Process â”€â”€â”€â”€â”¤ â”‚
â”‚  â”‚                                                       â”‚                â”‚                â”‚                  â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                                                              â”‚     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚                                  TOOL EXECUTION                                                              â”‚ â”‚
â”‚  â”‚                                                                                                  â”œâ”€Tool Callâ”€â”¤ â”‚
â”‚  â”‚                                                                                                  â”‚          â”‚ â”‚
â”‚  â”‚                                                                                                  â”œâ”€MCP Execâ”€â”¤ â”‚
â”‚  â”‚                                                                                                  â”‚          â”‚ â”‚
â”‚  â”‚                                                                                                  â”œâ”€Responseâ”€â”¤ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                                                                â”‚   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚                                 RESPONSE GENERATION                                                          â”‚ â”‚
â”‚  â”‚                                                                                                              â”œâ”€â”¤ â”‚
â”‚  â”‚                                                                                                              â”‚ â”‚
â”‚  â”‚                                                                                                     â”œâ”€Finalâ”€â”¤ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                                                                     â”‚
â”‚  Performance Metrics:                                                                                              â”‚
â”‚  â”œâ”€ Startup Time: 3-5 seconds                                                                                      â”‚
â”‚  â”œâ”€ Query Processing: 1-2 seconds                                                                                  â”‚
â”‚  â”œâ”€ LLM Processing: 5-10 seconds                                                                                   â”‚
â”‚  â”œâ”€ Tool Execution: 1-3 seconds                                                                                    â”‚
â”‚  â””â”€ Total Response Time: 7-15 seconds                                                                              â”‚
â”‚                                                                                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

This visual documentation provides comprehensive diagrams showing how data flows through the MCP Java Client system. Each diagram illustrates different aspects of the system from user interaction to internal processing and external integrations.

For detailed implementation information, refer to the other documentation files in this suite.
